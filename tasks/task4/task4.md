### объявление переменных рейнджа дат
    #v DateFrom=2021-01-01 
    #v DateTo=2021-03-01 

### объявлеяем блок кода чтобы получить список подразделений
    #src deps 
    #r 
        SELECT НАИМЕНОВАНИЕ, ССЫЛКА  FROM @<Справочники.Подразделения>@ 
    #query 
    #endsrc
Такой запрос выдаёт собственно справочник с подразделениями:

| наименование | ссылка |
|--------------|--------|
| Маг1         | 1      |
| Маг2         | 2      |
| Маг3         | 3      |

### основной блок кода
    SELECT
        DATE(Дата) AS 'Дата'
        #foreach deps
            , SUM(IF(DV.ПОДРАЗДЕЛЕНИЕ = '{deps.ССЫЛКА}', DV.КОЛИЧЕСТВО, 0)) AS '{deps.НАИМЕНОВАНИЕ}'
        #endfor
    FROM @<Таблицы.ДвижениеТовара>@ as DV
    WHERE DV.ДАТА BETWEEN '[DateFrom]' AND '[DateTo]'
    GROUP BY DATE(Дата)

Итоговый запрос здесь будет такой:

    SELECT
        DATE(Дата) AS 'Дата',
        SUM(IF(DV.ПОДРАЗДЕЛЕНИЕ = 1, DV.КОЛИЧЕСТВО, 0)) AS Маг1,
        SUM(IF(DV.ПОДРАЗДЕЛЕНИЕ = 2, DV.КОЛИЧЕСТВО, 0)) AS Маг2,
        SUM(IF(DV.ПОДРАЗДЕЛЕНИЕ = 3, DV.КОЛИЧЕСТВО, 0)) AS Маг3
    FROM ДвижениеТовара as DV
    WHERE DV.ДАТА BETWEEN '2021-01-01 ' AND '2021-03-01'
    GROUP BY DATE(Дата)

* отфильтровали по диапазону дат
* сгрупировали по дате
* взяли 4 столбца: дата, сумма движений_товара для каждого из 3 магазинов (для определенной даты)

В итоге получим такую выдачу:

| Дата       | Маг1 | Маг2 | Маг3 | 
|------------|------|------|------|
| 2021-01-01 | 0    | 1    | 0    |
| 2021-01-02 | 1    | 1    | 0    |
| 2021-01-03 | 0    | 0    | 1    |
| 2021-02-04 | 0    | 0    | 1    |
| 2021-02-10 | 0    | 0    | 1    |
| 2021-03-01 | 0    | 1    | 0    |
